<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ ‚Äî –ü—Ä–∞–∫—Ç–∏–∫–∞</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Nunito', sans-serif;
    }

    body {
      background: linear-gradient(135deg, #f0f9ff 0%, #e6f4ff 100%);
      color: #333;
      padding: 1.5rem;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* ‚Äî‚Äî‚Äî –ü–õ–ê–®–ö–ê: –ó–ï–õ–Å–ù–û-–§–ò–û–õ–ï–¢–û–í–´–ô –ì–†–ê–î–ò–ï–ù–¢ ‚Äî‚Äî‚Äî */
    .header-banner {
      background: linear-gradient(90deg, #6a1b9a, #4caf50); /* üü£ ‚Üí üü¢ */
      color: white;
      padding: 1.2rem 1.5rem;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 0.8rem;
    }

    .back-link-banner {
      display: inline-flex;
      align-items: center;
      color: white;
      text-decoration: none;
      font-weight: 600;
      gap: 0.5rem;
      font-size: 0.95rem;
      align-self: flex-start;
    }

    .banner-title-section {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      width: 100%;
      justify-content: space-between;
    }

    .banner-icon {
      font-size: 1.4rem;
    }

    .banner-title {
      font-size: 1.6rem;
      font-weight: 700;
      line-height: 1.3;
      margin: 0;
    }

    .progress-badge {
      background: rgba(255, 255, 255, 0.2);
      padding: 0.5rem 1rem;
      border-radius: 50px;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      font-size: 0.95rem;
      min-width: 70px;
      justify-content: center;
    }

    .progress-icon {
      font-size: 1.1rem;
    }

    /* ‚Äî‚Äî‚Äî –°–¢–ò–õ–ò –ó–ê–î–ê–ù–ò–ô ‚Äî‚Äî‚Äî */
    #app {
      max-width: 650px;
      margin: auto;
    }

    .card {
      background: white;
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.06);
      position: relative;
      transition: all 0.3s ease;
    }

    .card.locked {
      opacity: 0.55;
      transform: scale(0.96);
      pointer-events: none;
    }

    .card.completed {
      border-top: 5px solid #4caf50;
    }

    h2 {
      color: #6a1b9a;
      margin-top: 0;
      font-size: 1.5rem;
      font-weight: 700;
    }

    .question {
      margin: 16px 0;
      line-height: 1.5;
      white-space: pre-line;
      font-size: 1.05rem;
    }

    .options {
      margin: 20px 0;
    }

    .option {
      display: block;
      margin: 12px 0;
      padding: 14px 18px;
      background: #f8fbff;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 1.02rem;
    }

    .option:hover {
      background: #f3e8ff;
      border-color: #d1c4e9;
    }

    .option input {
      margin-right: 10px;
      transform: scale(1.25);
    }

    button {
      margin-top: 16px;
      padding: 12px 28px;
      font-size: 1.05rem;
      background: linear-gradient(to right, #6a1b9a, #4caf50);
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      box-shadow: 0 4px 10px rgba(106, 27, 154, 0.2);
    }

    button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 14px rgba(106, 27, 154, 0.3);
    }

    button:disabled {
      background: #dee2e6;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .result {
      margin-top: 16px;
      font-weight: 600;
      min-height: 24px;
      font-size: 1.1rem;
    }

    .badge {
      position: absolute;
      top: 16px;
      right: 16px;
      font-size: 0.8rem;
      padding: 4px 10px;
      border-radius: 50px;
      font-weight: 600;
    }

    .badge.locked { background: #e2e8f0; color: #64748b; }
    .badge.unlocked { background: #d1c4e9; color: #4a148c; }
    .badge.completed { background: #c8e6c9; color: #1b5e20; }

    .final-screen {
      text-align: center;
      padding: 40px 20px;
    }

    .final-screen h2 {
      color: #1b5e20;
      font-size: 1.8rem;
    }

    .score-display {
      font-size: 1.4rem;
      margin: 20px 0;
      color: #388e3c;
      font-weight: 700;
    }
  </style>
</head>
<body>

  <div class="container">

    <!-- üî∑ –ü–õ–ê–®–ö–ê -->
    <div class="header-banner">
      <a href="index.html" class="back-link-banner">
        <i class="fas fa-arrow-left"></i>
        –ù–∞–∑–∞–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é
      </a>
      <div class="banner-title-section">
        <div style="display: flex; align-items: center; gap: 0.8rem;">
          <i class="fas fa-calculator banner-icon"></i>
          <h1 class="banner-title">–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏</h1>
        </div>
        <div class="progress-badge" id="bannerProgress">
          <i class="fas fa-flag-checkered progress-icon"></i>
          <span>0 / 5</span>
        </div>
      </div>
    </div>

    <!-- üî∑ –¢–µ—Å—Ç -->
    <div id="app">
      <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å–∫—Ä–∏–ø—Ç–æ–º -->
    </div>

  </div>

  <script>
    const tasks = [
      {
        title: "–°–ª–æ–∂–Ω—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã",
        question: "–ò–Ω–≤–µ—Å—Ç–æ—Ä –≤–ª–æ–∂–∏–ª $1000 –ø–æ–¥ 8% –≥–æ–¥–æ–≤—ã—Ö –Ω–∞ 5 –ª–µ—Ç. –°–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç –¥–µ–Ω–µ–≥? (–æ–∫—Ä—É–≥–ª–∏ –¥–æ 2 –∑–Ω–∞–∫–æ–≤)",
        correct: "1469.33",
        options: ["1400.00", "1469.33", "1500.00", "1328.45"]
      },
      {
        title: "–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–∞",
        question: "–ê–∫—Ü–∏—è –≤—ã—Ä–æ—Å–ª–∞ —Å $50 –¥–æ $65. –ö–∞–∫–æ–≤–∞ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –≤ %?",
        correct: "30",
        options: ["25", "30", "130", "15"]
      },
      {
        title: "–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è",
        question: "60% –∞–∫—Ü–∏–π (10%) –∏ 40% –æ–±–ª–∏–≥–∞—Ü–∏–π (4%). –ù–∞–π–¥–∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è (%)",
        correct: "7.6",
        options: ["7.0", "7.6", "6.4", "8.2"]
      },
      {
        title: "–†–∏—Å–∫",
        question: "–ö–∞–∫–æ–π –∞–∫—Ç–∏–≤ –º–µ–Ω–µ–µ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–π? –í—ã–±–µ—Ä–∏ –±—É–∫–≤—É.\nA: —Ä–∏—Å–∫ 20%, B: —Ä–∏—Å–∫ 10%",
        correct: "B",
        options: ["A", "B", "–û–±–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ", "–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å"]
      },
      {
        title: "–ü–∞–¥–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞",
        question: "–ü–æ—Ä—Ç—Ñ–µ–ª—å $10 000 —É–ø–∞–ª –Ω–∞ 15%. –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å?",
        correct: "8500",
        options: ["8500", "1500", "9500", "8000"]
      }
    ];

    // üîí –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–∑ localStorage
    let current = 0;
    let score = 0;

    function loadProgress() {
      try {
        const saved = localStorage.getItem('mathModelsProgress');
        const progress = saved ? JSON.parse(saved) : { current: 0, score: 0 };
        current = Math.max(0, Math.min(tasks.length, progress.current || 0));
        score = progress.score || 0;

        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å—ã –∑–∞–¥–∞–Ω–∏–π
        for (let i = 0; i < tasks.length; i++) {
          const status = localStorage.getItem(`mathModelsTaskStatus-${i}`);
          if (status === 'correct' && i < current) {
            // –£–∂–µ –ø—Ä–æ–π–¥–µ–Ω–æ –≤–µ—Ä–Ω–æ
          } else if (status === 'incorrect' && i < current) {
            // –ü—Ä–æ–π–¥–µ–Ω–æ, –Ω–æ –Ω–µ–≤–µ—Ä–Ω–æ ‚Äî –≤—Å—ë —Ä–∞–≤–Ω–æ —Å—á–∏—Ç–∞–µ–º –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–º –ø–æ –ª–æ–≥–∏–∫–µ
          }
        }
      } catch (e) {
        console.warn('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:', e);
        current = 0;
        score = 0;
      }
    }

    function saveProgress() {
      try {
        localStorage.setItem('mathModelsProgress', JSON.stringify({ current, score }));
      } catch (e) {
        console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å:', e);
      }
    }

    function saveTaskStatus(index, isCorrect) {
      try {
        localStorage.setItem(
          `mathModelsTaskStatus-${index}`,
          isCorrect ? 'correct' : 'incorrect'
        );
      } catch (e) {
        console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞–Ω–∏—è:', e);
      }
    }

    function renderCards() {
      const app = document.getElementById("app");
      app.innerHTML = '';

      tasks.forEach((task, index) => {
        const card = document.createElement('div');
        card.className = 'card';

        let statusClass = 'locked';
        let badgeText = 'üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ';

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ current –∏ localStorage
        if (index < current) {
          const savedStatus = localStorage.getItem(`mathModelsTaskStatus-${index}`);
          if (savedStatus === 'correct') {
            card.classList.add('completed');
            statusClass = 'completed';
            badgeText = '‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ';
          } else {
            // –î–∞–∂–µ –µ—Å–ª–∏ –±—ã–ª –Ω–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞ (–º–æ–∂–Ω–æ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å)
            card.classList.add('completed');
            statusClass = 'completed';
            badgeText = '‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ';
          }
        } else if (index === current) {
          statusClass = 'unlocked';
          badgeText = 'üéØ –ê–∫—Ç–∏–≤–Ω–æ';
        } else {
          card.classList.add('locked');
        }

        const optionsHTML = task.options.map((opt, i) => `
          <label class="option">
            <input type="radio" name="task-${index}" value="${opt}" ${index !== current ? 'disabled' : ''}>
            ${opt}
          </label>
        `).join('');

        card.innerHTML = `
          <div class="badge ${statusClass}">${badgeText}</div>
          <h2>${task.title}</h2>
          <p class="question">${task.question}</p>
          <div class="options">${optionsHTML}</div>
          <button onclick="checkAnswer(${index})" ${index !== current ? 'disabled' : ''}>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          <p class="result" id="result-${index}"></p>
        `;

        // –ï—Å–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞ ‚Äî –±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –∏ –ø–æ–ª—è
        if (index < current) {
          const btn = card.querySelector('button');
          const inputs = card.querySelectorAll('input');
          if (btn) btn.disabled = true;
          inputs.forEach(inp => inp.disabled = true);
        }

        app.appendChild(card);
      });

      updateProgress();
    }

    function updateProgress() {
      document.getElementById('bannerProgress').innerHTML = 
        `<i class="fas fa-flag-checkered progress-icon"></i> <span>${current} / ${tasks.length}</span>`;
    }

    function checkAnswer(index) {
      if (index !== current) return;

      const radios = document.querySelectorAll(`input[name="task-${index}"]`);
      const selected = Array.from(radios).find(r => r.checked);
      const card = document.querySelectorAll('.card')[index];
      const resultEl = document.getElementById(`result-${index}`);
      const task = tasks[index];

      if (!selected) {
        resultEl.innerText = "‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤";
        resultEl.style.color = "#e53e3e";
        return;
      }

      const isCorrect = selected.value === task.correct;

      saveTaskStatus(index, isCorrect);

      if (isCorrect) {
        score += 10;
        resultEl.innerText = "‚úÖ –í–µ—Ä–Ω–æ!";
        resultEl.style.color = "#1b5e20";
        card.classList.add('completed');

        const badge = card.querySelector('.badge');
        if (badge) {
          badge.className = 'badge completed';
          badge.textContent = '‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ';
        }

        current++;

        saveProgress();

        if (current < tasks.length) {
          setTimeout(() => {
            const nextCard = document.querySelectorAll('.card')[current];
            nextCard.classList.remove('locked');

            const nextBadge = nextCard.querySelector('.badge');
            if (nextBadge) {
              nextBadge.className = 'badge unlocked';
              nextBadge.textContent = 'üéØ –ê–∫—Ç–∏–≤–Ω–æ';
            }

            const nextRadios = nextCard.querySelectorAll('input[type="radio"]');
            nextRadios.forEach(r => r.disabled = false);
            const nextBtn = nextCard.querySelector('button');
            if (nextBtn) nextBtn.disabled = false;

            nextCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }, 600);
        } else {
          setTimeout(showFinal, 1000);
        }

        updateProgress();
      } else {
        resultEl.innerText = "‚ùå –ù–µ–≤–µ—Ä–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.";
        resultEl.style.color = "#d32f2f";
      }
    }

    function showFinal() {
      const app = document.getElementById("app");
      const percent = Math.round((score / (tasks.length * 10)) * 100);
      let emoji = 'ü•â';
      if (percent >= 80) emoji = 'ü•á';
      else if (percent >= 60) emoji = 'ü•à';

      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
      saveProgress();

      app.innerHTML = `
        <div class="final-screen">
          <h2>${emoji} –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
          <div class="score-display">
            ${score} / ${tasks.length * 10} –±–∞–ª–ª–æ–≤ (${percent}%)
          </div>
          <p>–ü—Ä–æ–π–¥–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–π: <strong>${current}</strong> –∏–∑ ${tasks.length}</p>
          <div style="margin-top: 20px;">
            <button onclick="location.reload()" style="margin-right: 10px; font-size: 1.1rem;">
              üîÅ –ü—Ä–æ–π—Ç–∏ —Å–Ω–æ–≤–∞
            </button>
            <button onclick="resetProgress()" style="background: #6c757d; font-size: 1.1rem;">
              üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
            </button>
          </div>
        </div>
      `;
    }

    function resetProgress() {
      if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ ¬´–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –º–æ–¥–µ–ª—è–º¬ª?')) {
        localStorage.removeItem('mathModelsProgress');
        for (let i = 0; i < tasks.length; i++) {
          localStorage.removeItem(`mathModelsTaskStatus-${i}`);
        }
        location.reload();
      }
    }

    // üîì –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –∑–∞–≥—Ä—É–∑–∫–∞ ‚Üí —Ä–µ–Ω–¥–µ—Ä
    loadProgress();
    renderCards();
  </script>

</body>
</html>